<div class="profile-container">
  <!-- Header with User Info -->
  <div class="profile-header">
    <div class="user-info">
      <div class="avatar-section">
        <div class="avatar" *ngIf="!avatarUrl">{{ getInitials() }}</div>
        <img *ngIf="avatarUrl" [src]="avatarUrl" alt="Profile avatar" class="avatar-image" />
        <div class="avatar-actions" *ngIf="isSeller()">
          <input
            type="file"
            #avatarFileInput
            accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
            (change)="onAvatarFileSelected($event)"
            class="file-input-hidden"
          />
          <button
            class="btn-avatar-action"
            (click)="avatarFileInput.click()"
            [disabled]="isUploadingAvatar"
          >
            {{ avatarUrl ? 'ğŸ“·' : 'â•' }}
          </button>
          <button
            *ngIf="avatarUrl"
            class="btn-avatar-action btn-delete"
            (click)="deleteAvatar()"
            [disabled]="isUploadingAvatar"
          >
            ğŸ—‘ï¸
          </button>
        </div>
        <div *ngIf="isUploadingAvatar" class="avatar-loading">Uploading...</div>
        <div *ngIf="avatarError" class="avatar-error">{{ avatarError }}</div>
      </div>
      <div class="user-details">
        <h1>{{ currentUser?.name }}</h1>
        <p class="email">{{ currentUser?.email }}</p>
        <span class="role-badge" [ngClass]="'role-' + currentUser?.role">
          {{ currentUser?.role === 'seller' ? 'Seller' : 'Buyer' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Seller View: Products for Sale -->
  <div *ngIf="isSeller()" class="seller-section">
    <div class="section-header">
      <h2>My Products for Sale</h2>
      <a routerLink="/seller/dashboard" class="btn btn-primary">Manage Products</a>
    </div>

    <div class="seller-actions">
      <a routerLink="/analytics" class="action-card action-analytics">
        <div class="action-icon">ğŸ“Š</div>
        <div class="action-content">
          <h3>Analytics</h3>
          <p>View sales statistics and revenue insights</p>
        </div>
      </a>
    </div>

    <div *ngIf="isLoading" class="loading">Loading your products...</div>

    <div *ngIf="!isLoading && sellerProducts.length === 0" class="empty-state">
      <p>You haven't listed any products yet.</p>
      <a routerLink="/seller/dashboard" class="btn btn-primary">Create Your First Product</a>
    </div>

    <div *ngIf="!isLoading && sellerProducts.length > 0" class="products-grid">
      <div *ngFor="let product of sellerProducts" class="product-card">
        <div class="product-image">
          <app-image-slider
            *ngIf="getProductImages(product.id!).length > 0"
            [images]="getProductImages(product.id!)"
            [alt]="product.name"
          ></app-image-slider>
          <div *ngIf="getProductImages(product.id!).length === 0" class="no-image">No Image</div>
        </div>
        <div class="product-info">
          <h3>{{ product.name }}</h3>
          <p class="description">{{ product.description | slice : 0 : 60 }}...</p>
          <div class="product-meta">
            <span class="price">${{ product.price | number : '1.2-2' }}</span>
            <span class="stock">Stock: {{ product.stock }}</span>
          </div>
          <div class="product-actions">
            <a
              [routerLink]="['/seller/dashboard']"
              [queryParams]="{ productId: product.id }"
              class="btn btn-sm btn-secondary"
            >
              Edit
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Buyer View: Quick Actions -->
  <div *ngIf="isBuyer()" class="buyer-section">
    <div class="section-header">
      <h2>My Account</h2>
      <a routerLink="/products" class="btn btn-primary">Browse Products</a>
    </div>

    <div class="buyer-actions">
      <a routerLink="/orders" class="action-card action-orders">
        <div class="action-icon">ğŸ“‹</div>
        <div class="action-content">
          <h3>View Order History</h3>
          <p>Track your orders and view past purchases</p>
        </div>
      </a>
      <a routerLink="/cart" class="action-card action-cart">
        <div class="action-icon">ğŸ›’</div>
        <div class="action-content">
          <h3>Shopping Cart</h3>
          <p>View items in your cart and checkout</p>
        </div>
      </a>
      <a routerLink="/analytics" class="action-card action-analytics">
        <div class="action-icon">ğŸ“Š</div>
        <div class="action-content">
          <h3>Analytics</h3>
          <p>View your spending statistics and insights</p>
        </div>
      </a>
    </div>
  </div>
</div>
